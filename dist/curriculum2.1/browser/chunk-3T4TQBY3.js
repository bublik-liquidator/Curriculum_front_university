import{a as g}from"./chunk-TBTQX2NF.js";import{a as V,c as f}from"./chunk-3MLLPJBA.js";import{c as H}from"./chunk-MN3BMMZP.js";import{Aa as E,Ba as h,F as l,G as n,H as D,La as x,Oa as F,P as I,Pa as N,T as v,U as y,a as _,ba as T,c as S,ca as C,g as j,ha as k,ja as B,l as b,lb as P,m as w,n as M,na as O,ra as d,sa as p,xa as R,y as u}from"./chunk-KKIUVDZZ.js";function U(r,o){if(r&1){let m=R();d(0,"tablec",6),E("delete",function(e){v(m);let i=h();return y(i.onDelete(e))})("edit",function(e){v(m);let i=h();return y(i.onEdit(e))}),p()}if(r&2){let m=h();B("data",m.tableData)}}var Y=(()=>{let o=class o{constructor(t,e){this.dialog=t,this.educationService=e,this.destroySubject=new j}ngOnInit(){this.getEducations()}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete()}getEducations(){this.educationService.getEducations().pipe(n(this.destroySubject)).subscribe(t=>{this.educations=t,this.tableData=this.mapToTableData(t)})}getEducationById(t){this.educationService.getEducationById(t).pipe(n(this.destroySubject)).subscribe(e=>{this.educationById=e})}onEdit(t){this.educationService.getEducationById(t).pipe(l(e=>{let i=[{field:"title",fieldName:"\u0418\u043C\u044F",type:"string",value:e.name}],a=[{field:"save-button",type:"submit",value:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041E\u0442\u043C\u0435\u043D\u0430",click:()=>s.close()}],s=this.dialog.open(f,{data:{fields:i,buttons:a}});return s.afterClosed()}),n(this.destroySubject),u(e=>(console.error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",e),this.openModal(e.error.error),w(e)))).subscribe(e=>{e&&(this.getEducations(),this.saveEducations(e,t),this.getEducations())})}saveEducations(t,e){this.educationService.updateEducationById(e,t).pipe(l(()=>this.openModal("\u0414\u0430\u043D\u043D\u044B\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u044B")),u(i=>this.openModal(i.error.error)),n(this.destroySubject)).subscribe()}openModal(t){let e=this.dialog.open(f,{data:{fields:[{field:"name",type:"info",value:t}]}});return e.afterClosed().pipe(M(()=>e),n(this.destroySubject))}mapToTableData(t){return t.map(s=>{var c=s,{id:e,name:i}=c,a=S(c,["id","name"]);return _({id:e,\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:i},a)})}createEducation(){let t=this.dialog.open(f,{data:{fields:[{field:"title",fieldName:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",type:"string",value:"\u0422\u0435\u0441\u04421"}],buttons:[{field:"save-button",type:"submit",value:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041E\u0442\u043C\u0435\u043D\u0430",click:()=>t.close()}]}});return t.afterClosed().pipe(l(e=>e?this.educationService.createEducation(e).pipe(D(()=>{this.getEducations()}),n(this.destroySubject)):b(null)),u(e=>(console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430:",e),this.openModal(e.error.error),b(null)))).subscribe()}onDelete(t){let e=[{field:"name",type:"info",value:"\u0412\u044B \u0442\u043E\u0447\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u043E\u0443 \u0444\u043E\u0440\u043C\u0443 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F?"}],i=[{field:"save-button ",type:"submit",value:"\u0414\u0430"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041D\u0435\u0442",click:()=>a.close()}],a=this.dialog.open(f,{data:{fields:e,buttons:i}});a.afterClosed().pipe(l(s=>s?this.educationService.deleteEducationById(t).pipe(u(c=>(console.log(c.error),this.openModal(c.error.error)))):b(null)),n(this.destroySubject)).subscribe(()=>{this.getEducations()})}};o.\u0275fac=function(e){return new(e||o)(C(V),C(g))},o.\u0275cmp=I({type:o,selectors:[["education-content"]],standalone:!0,features:[F([g]),N],decls:8,vars:1,consts:[[1,"main-container"],[1,"header"],[1,"title"],[1,"create-education-button",3,"click"],[1,"tablic"],[3,"data"],[3,"data","delete","edit"]],template:function(e,i){e&1&&(d(0,"div",0)(1,"div",1)(2,"div",2),x(3,"\u0424\u043E\u0440\u043C\u0430 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F"),p(),d(4,"button",3),E("click",function(){return i.createEducation()}),x(5," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0444\u043E\u0440\u043C\u0443 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F "),p()(),d(6,"div",4),k(7,U,1,1,"tablec",5),p()()),e&2&&(T(7),O(7,i.tableData?7:-1))},dependencies:[H,P],styles:[".main-container[_ngcontent-%COMP%]{border-radius:8px;justify-content:space-between;display:flex;flex-direction:column;padding-top:20px;padding-right:30px;padding-left:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.create-education-button[_ngcontent-%COMP%]{color:var(--Colors-white, #fff);white-space:nowrap;border-radius:4px;box-shadow:0 1px 2px -1px #0000001a,0 1px 3px #0000001a;background-color:var(--Colors-primary-500, #0ea5e9);align-self:stretch;justify-content:center;padding:8px 16px;font:800 16px/143% Inter,-apple-system,Roboto,Helvetica,sans-serif;border:none;cursor:pointer}.title[_ngcontent-%COMP%]{color:var(--Colors-gray-600, #475569);white-space:nowrap;font:400 24px/32px Inter,-apple-system,Roboto,Helvetica,sans-serif;padding-left:3px}"]});let r=o;return r})();export{Y as EducationContentComponent};
