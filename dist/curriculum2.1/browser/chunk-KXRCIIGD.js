import{a as h}from"./chunk-B5VD4SON.js";import"./chunk-BYXBJQAS.js";import{a as V,c as d}from"./chunk-3MLLPJBA.js";import{c as H}from"./chunk-MN3BMMZP.js";import{Aa as x,Ba as y,F as c,G as n,H as E,La as _,Oa as R,P as I,Pa as F,T as g,U as v,a as j,ba as T,c as w,ca as C,g as M,ha as k,ja as B,l as b,lb as N,m as S,n as D,na as O,ra as p,sa as u,xa as P,y as r}from"./chunk-KKIUVDZZ.js";function U(s,o){if(s&1){let f=P();p(0,"tablec",6),x("delete",function(e){g(f);let i=y();return v(i.onDelete(e))})("edit",function(e){g(f);let i=y();return v(i.onEdit(e))}),u()}if(s&2){let f=y();B("data",f.tableData)}}var $=(()=>{let o=class o{constructor(t,e){this.dialog=t,this.specialtyService=e,this.destroySubject=new M}ngOnInit(){this.getSpecialties()}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete()}getSpecialties(){this.specialtyService.getSpecialties().pipe(n(this.destroySubject)).subscribe(t=>{this.specialties=t,this.tableData=this.mapToTableData(t)})}getSpecialtyById(t){this.specialtyService.getSpecialyById(t).pipe(n(this.destroySubject)).subscribe(e=>{this.specialtiesById=e})}onEdit(t){this.specialtyService.getSpecialyById(t).pipe(c(e=>{let i=[{field:"title",fieldName:"\u0418\u043C\u044F",type:"string",value:e.name}],a=[{field:"save-button",type:"submit",value:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041E\u0442\u043C\u0435\u043D\u0430",click:()=>l.close()}],l=this.dialog.open(d,{data:{fields:i,buttons:a}});return l.afterClosed()}),n(this.destroySubject),r(e=>(this.openModal(e.error),console.error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",e),S(e)))).subscribe(e=>{e&&(this.getSpecialties(),this.saveSpecialties(e,t),this.getSpecialties())})}saveSpecialties(t,e){this.specialtyService.updateSpecialtyById(e,t).pipe(c(()=>this.openModal("\u0414\u0430\u043D\u043D\u044B\u0435 \u0443\u0447\u0435\u0431\u043D\u043E\u0439 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u044B")),r(i=>this.openModal(i.error)),n(this.destroySubject)).subscribe()}openModal(t){let e=this.dialog.open(d,{data:{fields:[{field:"name",type:"info",value:t}]}});return e.afterClosed().pipe(D(()=>e),n(this.destroySubject))}mapToTableData(t){return t.map(l=>{var m=l,{id:e,name:i}=m,a=w(m,["id","name"]);return j({id:e,\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:i},a)})}createSpeciality(){let t=this.dialog.open(d,{data:{fields:[{field:"title",fieldName:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",type:"string",value:"\u0422\u0435\u0441\u04421"}],buttons:[{field:"save-button",type:"submit",value:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041E\u0442\u043C\u0435\u043D\u0430",click:()=>t.close()}]}});return t.afterClosed().pipe(c(e=>e?this.specialtyService.createSpecialties(e).pipe(E(()=>{this.getSpecialties()}),r(i=>(this.openModal(i.error),console.error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0441\u043F\u0435\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u044C",i),S(i))),n(this.destroySubject)):b(null))).subscribe()}onDelete(t){let e=[{field:"name",type:"info",value:"\u0412\u044B \u0442\u043E\u0447\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u0443 \u0441\u043F\u0435\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u044C?"}],i=[{field:"save-button ",type:"submit",value:"\u0414\u0430"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041D\u0435\u0442",click:()=>a.close()}],a=this.dialog.open(d,{data:{fields:e,buttons:i}});a.afterClosed().pipe(c(l=>l?this.specialtyService.deleteSpecialtiesById(t).pipe(r(m=>(this.openModal(m.error),b(null)))):b(null)),n(this.destroySubject)).subscribe(()=>{this.getSpecialties()})}};o.\u0275fac=function(e){return new(e||o)(C(V),C(h))},o.\u0275cmp=I({type:o,selectors:[["specialty-content"]],standalone:!0,features:[R([h]),F],decls:8,vars:1,consts:[[1,"main-container"],[1,"header"],[1,"title"],[1,"create-speciality-button",3,"click"],[1,"tablic"],[3,"data"],[3,"data","delete","edit"]],template:function(e,i){e&1&&(p(0,"div",0)(1,"div",1)(2,"div",2),_(3,"\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438"),u(),p(4,"button",3),x("click",function(){return i.createSpeciality()}),_(5," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0441\u043F\u0435\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u044C "),u()(),p(6,"div",4),k(7,U,1,1,"tablec",5),u()()),e&2&&(T(7),O(7,i.tableData?7:-1))},dependencies:[H,N],styles:[".main-container[_ngcontent-%COMP%]{border-radius:8px;justify-content:space-between;display:flex;flex-direction:column;padding-top:20px;padding-right:30px;padding-left:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.create-speciality-button[_ngcontent-%COMP%]{color:var(--Colors-white, #fff);white-space:nowrap;border-radius:4px;box-shadow:0 1px 2px -1px #0000001a,0 1px 3px #0000001a;background-color:var(--Colors-primary-500, #0ea5e9);align-self:stretch;justify-content:center;padding:8px 16px;font:800 16px/143% Inter,-apple-system,Roboto,Helvetica,sans-serif;border:none;cursor:pointer}.title[_ngcontent-%COMP%]{color:var(--Colors-gray-600, #475569);white-space:nowrap;font:400 24px/32px Inter,-apple-system,Roboto,Helvetica,sans-serif;padding-left:3px}"]});let s=o;return s})();export{$ as SpecialtyContentComponent};
