import{a as S}from"./chunk-ZMACHNUF.js";import"./chunk-BYXBJQAS.js";import{a as F,c as f}from"./chunk-3MLLPJBA.js";import{c as H}from"./chunk-MN3BMMZP.js";import{Aa as C,Ba as h,F as u,G as n,H as I,La as x,Oa as R,P as E,Pa as N,T as g,U as v,a as _,ba as T,c as j,ca as y,g as w,ha as k,ja as B,l as b,lb as V,m as M,n as D,na as O,ra as p,sa as d,xa as P,y as c}from"./chunk-KKIUVDZZ.js";function U(a,o){if(a&1){let m=P();p(0,"tablec",6),C("delete",function(e){g(m);let i=h();return v(i.onDelete(e))})("edit",function(e){g(m);let i=h();return v(i.onEdit(e))}),d()}if(a&2){let m=h();B("data",m.tableData)}}var $=(()=>{let o=class o{constructor(t,e){this.dialog=t,this.statusService=e,this.destroySubject=new w}ngOnInit(){this.getSpecialties()}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete()}getSpecialties(){this.statusService.getStatuses().pipe(n(this.destroySubject)).subscribe(t=>{this.statuses=t,this.tableData=this.mapToTableData(t)})}getSpecialtyById(t){this.statusService.getStatusById(t).pipe(n(this.destroySubject)).subscribe(e=>{this.statusById=e})}onEdit(t){this.statusService.getStatusById(t).pipe(u(e=>{let i=[{field:"title",fieldName:"\u0418\u043C\u044F",type:"string",value:e.name}],s=[{field:"save-button",type:"submit",value:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041E\u0442\u043C\u0435\u043D\u0430",click:()=>r.close()}],r=this.dialog.open(f,{data:{fields:i,buttons:s}});return r.afterClosed()}),n(this.destroySubject),c(e=>(console.error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",e),this.openModal(e.error.error),M(e)))).subscribe(e=>{e&&(this.getSpecialties(),this.saveSpecialties(e,t),this.getSpecialties())})}saveSpecialties(t,e){this.statusService.updateStatusById(e,t).pipe(u(()=>this.openModal("\u0414\u0430\u043D\u043D\u044B\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u044B")),c(i=>this.openModal(i.error.error)),n(this.destroySubject)).subscribe()}openModal(t){let e=this.dialog.open(f,{data:{fields:[{field:"name",type:"info",value:t}]}});return e.afterClosed().pipe(D(()=>e),n(this.destroySubject))}mapToTableData(t){return t.map(r=>{var l=r,{id:e,name:i}=l,s=j(l,["id","name"]);return _({id:e,\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:i},s)})}createStatus(){let t=this.dialog.open(f,{data:{fields:[{field:"title",fieldName:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",type:"string",value:"\u0422\u0435\u0441\u04421"}],buttons:[{field:"save-button",type:"submit",value:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041E\u0442\u043C\u0435\u043D\u0430",click:()=>t.close()}]}});return t.afterClosed().pipe(u(e=>e?this.statusService.createStatus(e).pipe(I(()=>{this.getSpecialties()}),n(this.destroySubject)):b(null)),c(e=>(console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430:",e),this.openModal(e.error.error),b(null)))).subscribe()}onDelete(t){let e=[{field:"name",type:"info",value:"\u0412\u044B \u0442\u043E\u0447\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u043E\u0442 \u0441\u0442\u0430\u0442\u0443\u0441?"}],i=[{field:"save-button ",type:"submit",value:"\u0414\u0430"},{field:"cancel-button",fieldName:"Cancel",type:"button",value:"\u041D\u0435\u0442",click:()=>s.close()}],s=this.dialog.open(f,{data:{fields:e,buttons:i}});s.afterClosed().pipe(u(r=>r?this.statusService.deleteStatusById(t).pipe(c(l=>(console.log(l.error),this.openModal(l.error.error)))):b(null)),n(this.destroySubject)).subscribe(()=>{this.getSpecialties()})}};o.\u0275fac=function(e){return new(e||o)(y(F),y(S))},o.\u0275cmp=E({type:o,selectors:[["status-content"]],standalone:!0,features:[R([S]),N],decls:8,vars:1,consts:[[1,"main-container"],[1,"header"],[1,"title"],[1,"create-status-button",3,"click"],[1,"tablic"],[3,"data"],[3,"data","delete","edit"]],template:function(e,i){e&1&&(p(0,"div",0)(1,"div",1)(2,"div",2),x(3,"\u0421\u0442\u0430\u0442\u0443\u0441\u044B"),d(),p(4,"button",3),C("click",function(){return i.createStatus()}),x(5," \u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0441\u0442\u0430\u0442\u0443\u0441 "),d()(),p(6,"div",4),k(7,U,1,1,"tablec",5),d()()),e&2&&(T(7),O(7,i.tableData?7:-1))},dependencies:[H,V],styles:[".main-container[_ngcontent-%COMP%]{border-radius:8px;justify-content:space-between;display:flex;flex-direction:column;padding-top:20px;padding-right:30px;padding-left:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.create-status-button[_ngcontent-%COMP%]{color:var(--Colors-white, #fff);white-space:nowrap;border-radius:4px;box-shadow:0 1px 2px -1px #0000001a,0 1px 3px #0000001a;background-color:var(--Colors-primary-500, #0ea5e9);align-self:stretch;justify-content:center;padding:8px 16px;font:800 16px/143% Inter,-apple-system,Roboto,Helvetica,sans-serif;border:none;cursor:pointer}.title[_ngcontent-%COMP%]{color:var(--Colors-gray-600, #475569);white-space:nowrap;font:400 24px/32px Inter,-apple-system,Roboto,Helvetica,sans-serif;padding-left:3px}"]});let a=o;return a})();export{$ as StatusContentComponent};
